<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kalça Sağlığı Değerlendirme Formu (HHS)</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; line-height: 1.6; background-color: #f0f2f5; color: #333; padding: 10px; }
        .container { max-width: 700px; margin: auto; background: white; padding: 25px; border-radius: 15px; box-shadow: 0 8px 25px rgba(0,0,0,0.1); }
        h1 { color: #0056b3; text-align: center; border-bottom: 3px solid #0056b3; padding-bottom: 10px; margin-bottom: 25px; }
        .bilgi-notu { background-color: #e7f3ff; border-left: 5px solid #007bff; padding: 15px; margin-bottom: 20px; font-size: 0.95em; border-radius: 0 8px 8px 0; }
        h2 { font-size: 1.2em; color: white; background: #0056b3; padding: 10px 15px; border-radius: 8px; margin-top: 30px; }
        .soru-alani { margin-bottom: 20px; padding: 15px; border-bottom: 1px solid #eee; }
        .soru-metni { font-weight: bold; color: #2c3e50; display: block; margin-bottom: 12px; font-size: 1.05em; }
        .secenek { display: block; margin-bottom: 12px; cursor: pointer; padding: 10px; border-radius: 6px; transition: background 0.2s; }
        .secenek:hover { background: #f8f9fa; }
        .secenek input { margin-right: 15px; transform: scale(1.4); }
        
        /* ONAY KUTUSU */
        .onam-cercevesi { background: #fff9db; border: 2px solid #fab005; padding: 20px; border-radius: 12px; margin: 30px 0; }
        .onam-baslik { font-weight: bold; color: #856404; display: block; margin-bottom: 10px; }
        
        #sonuc-ekrani { display: none; margin-top: 30px; padding: 25px; border-radius: 12px; text-align: center; animation: fadeIn 0.5s; }
        .basarili { background: #d4edda; color: #155724; border: 2px solid #c3e6cb; }
        
        button { width: 100%; padding: 18px; border: none; border-radius: 10px; font-size: 1.2em; font-weight: bold; cursor: pointer; transition: 0.3s; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        #hesaplaBtn { background: #007bff; color: white; }
        #gonderBtn { background: #6c757d; color: white; margin-top: 15px; cursor: not-allowed; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>

<div class="container">
    <h1>Kalça Durum Değerlendirmesi</h1>

    <div class="bilgi-notu">
        <strong>Değerli Hastamız,</strong><br>
        Bu form, kalçanızdaki ağrıyı ve günlük hareketlerinizi ne kadar rahat yapabildiğinizi anlamamıza yardımcı olacaktır. Lütfen durumunuzu en iyi anlatan seçeneği işaretleyiniz.
    </div>

    <div class="soru-alani">
        <label class="soru-metni">Adınız Soyadınız:</label>
        <input type="text" id="hastaAdi" style="width:100%; padding:12px; border:2px solid #ddd; border-radius:8px; font-size:1em;" placeholder="Örn: Ahmet Yılmaz">
    </div>

    <h2>1. Kalça Ağrınızın Durumu</h2>
    <div class="soru-alani">
        <label class="secenek"><input type="radio" name="pain" value="44"> Hiç ağrım yok</label>
        <label class="secenek"><input type="radio" name="pain" value="40"> Çok hafif, bazen oluyor, hareketlerimi hiç kısıtlamıyor</label>
        <label class="secenek"><input type="radio" name="pain" value="30"> Hafif ağrım var; normal işlerimi yapabiliyorum, nadiren orta şiddete çıkıyor</label>
        <label class="secenek"><input type="radio" name="pain" value="20"> Orta derece ağrım var; ağrı nedeniyle bazı hareketlerimi kısıtlıyorum</label>
        <label class="secenek"><input type="radio" name="pain" value="10"> Şiddetli ağrım var; hareketlerimi ciddi şekilde engelliyor</label>
        <label class="secenek"><input type="radio" name="pain" value="0"> Çok şiddetli ağrım var; yatağa bağımlıyım, ağrı hiç geçmiyor</label>
    </div>

    <h2>2. Yürüme ve Hareket Kabiliyetiniz</h2>
    
    <span class="soru-metni">Yürürken aksıyor musunuz?</span>
    <div class="soru-alani">
        <label class="secenek"><input type="radio" name="limp" value="11"> Hayır, hiç aksamıyorum</label>
        <label class="secenek"><input type="radio" name="limp" value="8"> Evet, hafif derecede aksıyorum</label>
        <label class="secenek"><input type="radio" name="limp" value="5"> Evet, orta derecede aksıyorum</label>
        <label class="secenek"><input type="radio" name="limp" value="0"> Evet, çok belirgin aksıyorum veya yürüyemiyorum</label>
    </div>

    <span class="soru-metni">Yürürken bir destek (baston vb.) kullanıyor musunuz?</span>
    <div class="soru-alani">
        <label class="secenek"><input type="radio" name="support" value="11"> Hayır, herhangi bir destek kullanmıyorum</label>
        <label class="secenek"><input type="radio" name="support" value="7"> Sadece uzun yürüyüşlerde baston kullanıyorum</label>
        <label class="secenek"><input type="radio" name="support" value="5"> Çoğu zaman baston kullanıyorum</label>
        <label class="secenek"><input type="radio" name="support" value="3"> Tek koltuk değneği kullanıyorum</label>
        <label class="secenek"><input type="radio" name="support" value="2"> İki baston kullanıyorum</label>
        <label class="secenek"><input type="radio" name="support" value="0"> İki koltuk değneği kullanıyorum veya hiç yürüyemiyorum</label>
    </div>

    <span class="soru-metni">Dinlenmeden ne kadar mesafe yürüyebiliyorsunuz?</span>
    <div class="soru-alani">
        <label class="secenek"><input type="radio" name="distance" value="11"> Sınırsız yürüyebilirim</label>
        <label class="secenek"><input type="radio" name="distance" value="8"> Yaklaşık 1 kilometre (veya 30 dakika aralıksız) yürüyebilirim</label>
        <label class="secenek"><input type="radio" name="distance" value="5"> Yaklaşık 500 metre (veya 15 dakika) yürüyebilirim</label>
        <label class="secenek"><input type="radio" name="distance" value="2"> Sadece ev içerisinde yürüyebilirim</label>
        <label class="secenek"><input type="radio" name="distance" value="0"> Sadece yatak veya koltuk arasını yürüyebilirim</label>
    </div>

    <h2>3. Günlük Aktiviteleriniz</h2>
    <div class="soru-alani">
        <p class="soru-metni">Merdivenleri nasıl çıkıyorsunuz?</p>
        <label class="secenek"><input type="radio" name="stairs" value="4"> Normal şekilde, korkuluklara tutunmadan</label>
        <label class="secenek"><input type="radio" name="stairs" value="2"> Normal şekilde ama korkuluklara tutunarak</label>
        <label class="secenek"><input type="radio" name="stairs" value="1"> Herhangi bir şekilde, çok zorlanarak</label>
        <label class="secenek"><input type="radio" name="stairs" value="0"> Merdiven çıkamıyorum</label>
        
        <p class="soru-metni">Çorap veya ayakkabınızı nasıl giyiyorsunuz?</p>
        <label class="secenek"><input type="radio" name="socks" value="4"> Kolaylıkla giyebiliyorum</label>
        <label class="secenek"><input type="radio" name="socks" value="2"> Biraz zorlanarak giyebiliyorum</label>
        <label class="secenek"><input type="radio" name="socks" value="0"> Hiç giyemiyorum</label>

        <p class="soru-metni">Sandalyede ne kadar süre rahat oturabiliyorsunuz?</p>
        <label class="secenek"><input type="radio" name="sit" value="5"> Herhangi bir sandalyede 1 saat rahatça oturabilirim</label>
        <label class="secenek"><input type="radio" name="sit" value="3"> Yüksek bir sandalyede en fazla 30 dakika oturabilirim</label>
        <label class="secenek"><input type="radio" name="sit" value="0"> Hiçbir sandalyede rahat oturamıyorum</label>

        <p class="soru-metni">Toplu taşıma araçlarına (otobüs, metro vb.) binebiliyor musunuz?</p>
        <label class="secenek"><input type="radio" name="bus" value="1"> Evet, binebiliyorum</label>
        <label class="secenek"><input type="radio" name="bus" value="0"> Hayır, binemiyorum</label>
    </div>

    <div class="onam-cercevesi">
        <span class="onam-baslik">Veri Kullanım ve Araştırma Onayı</span>
        <p style="font-size: 0.85em; color: #555; margin-bottom: 15px;">
            Girdiğiniz bu bilgiler, kalça sağlığınızın değerlendirilmesi ve anonim (isminiz gizli tutularak) akademik çalışmalar kapsamında kullanılabilir. Bilgilerinizin güvenli bir şekilde işlenmesini ve doktorunuza iletilmesini onaylıyor musunuz?
        </p>
        <label style="font-weight: bold; cursor: pointer; display: flex; align-items: center; gap: 10px;">
            <input type="checkbox" id="onayKutusu" style="width: 22px; height: 22px;"> Bilgilerimin bilimsel amaçla anonim olarak kullanılmasını onaylıyorum.
        </label>
    </div>

    <button id="hesaplaBtn" onclick="skorHesapla()">DEĞERLENDİRMEYİ TAMAMLA</button>

    <div id="sonuc-ekrani" class="basarili">
        <h2 id="skorSonuc" style="background:none; color:inherit; font-size:1.8em; margin-bottom:5px;">Skorunuz: 0</h2>
        <p id="dereceSonuc" style="font-size:1.1em; font-weight:bold;"></p>
        <p style="font-size: 0.8em; color: #555;">(Not: Fizik muayene kısımları doktorunuz tarafından eklenecektir.)</p>
        
        <button id="gonderBtn" onclick="doktoraGonder()" disabled>Sonuçları Doktoruma WhatsApp ile Gönder</button>
    </div>
</div>

<script>
    // URL'den doktorun telefon numarasını alıyoruz
    const urlSorgu = new URLSearchParams(window.location.search);
    const doktorTelefon = urlSorgu.get('phone');

    // Onay kutusu kontrolü: İşaretlenmeden WhatsApp butonu aktif olmaz
    document.getElementById('onayKutusu').addEventListener('change', function() {
        const btn = document.getElementById('gonderBtn');
        if (this.checked) {
            btn.disabled = false;
            btn.style.backgroundColor = "#25D366"; // WhatsApp Yeşili
            btn.style.cursor = "pointer";
        } else {
            btn.disabled = true;
            btn.style.backgroundColor = "#6c757d";
            btn.style.cursor = "not-allowed";
        }
    });

    function skorHesapla() {
        let toplam = 0;
        const secilenler = document.querySelectorAll('input[type="radio"]:checked');
        
        // Puanları topluyoruz
        secilenler.forEach(secenek => toplam += parseInt(secenek.value));

        // Varsayılan olarak Doktor kısımları (Deformite ve ROM) 0 puan ekleniyor (User talebi üzerine)
        // Normalde doktor muayenesi sonrası bu skora +9 puana kadar eklenebilir.

        const sonucDiv = document.getElementById('sonuc-ekrani');
        const dereceP = document.getElementById('dereceSonuc');
        document.getElementById('skorSonuc').innerText = "Hasta Bildirim Skoru: " + toplam;

        sonucDiv.style.display = 'block';
        
        // Derecelendirme (Doktor puanı olmadan sadece hasta kısmına göre)
        if(toplam >= 80) dereceP.innerText = "Durum: Çok İyi";
        else if(toplam >= 60) dereceP.innerText = "Durum: Orta";
        else dereceP.innerText = "Durum: Zayıf";

        sonucDiv.scrollIntoView({ behavior: 'smooth' });
    }

    function doktoraGonder() {
        if (!doktorTelefon) {
            alert("Hata: Alıcı doktor numarası bulunamadı.");
            return;
        }

        const isim = document.getElementById('hastaAdi').value || "Belirtilmedi";
        const skor = document.getElementById('skorSonuc').innerText;
        const derece = document.getElementById('dereceSonuc').innerText;
        
        let mesaj = `*Harris Kalça Skoru (Hasta Bildirimi)*\n\n`;
        mesaj += `Hasta: *${isim}*\n`;
        mesaj += `${skor} / 91 (Muayene Hariç)\n`;
        mesaj += `${derece}\n\n`;
        mesaj += `_Bu form hasta tarafından bilimsel onam verilerek doldurulmuştur._`;

        window.open(`https://wa.me/${doktorTelefon}?text=${encodeURIComponent(mesaj)}`, '_blank');
    }
</script>

</body>
</html>
